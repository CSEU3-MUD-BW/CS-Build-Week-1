import tracery
from tracery.modifiers import base_english

basicRoomFeatures = 'panel,light,cable'

rules = {
    'setRoomName': [
        f'[roomName:room][feature:{basicRoomFeatures}]',
        f'[roomName:corridor][feature:{basicRoomFeatures}]',
        f'[roomName:medbay][feature:{basicRoomFeatures},medkit,empty bed]',
        f'[roomName:armoury][feature:{basicRoomFeatures},phaser,pistol,assault rifle,grenade,odd-looking gun]',
        f'[roomName:quarters][feature:{basicRoomFeatures},mirror,jewel,family photo]',
        f'[roomName:bridge][feature:{basicRoomFeatures},chair,flight computer]',
        f'[roomName:brig][feature:{basicRoomFeatures},force field,handcuff]',
        f'[roomName:passageway][feature:{basicRoomFeatures},communicator]',
        f'[roomName:laboratory][feature:{basicRoomFeatures},test tube,centrifuge,lazer]',
        f'[roomName:mess-hall][feature:{basicRoomFeatures},pot,pan,vegetable,fruit,plate,knife,fork,replicator]',
        f'[roomName:engine-room][feature:{basicRoomFeatures},pipe,reactor,green gelatinous puddle]',
    ],
    'roomAdjective': ['dark', 'smoky', 'dangerous-looking', 'messy', 'quiet', 'irradiated', 'full', 'empty', 'packed', 'stripped', 'ransacked'],
    'featureAdjective': ['smoking', 'broken', 'flashing', 'beeping', 'oversized', 'odd-looking', 'unfamiliar', 'sharp', 'hot', 'regular'],

    'adverb': ['suspiciously', 'strangely', 'worryingly', 'puzzlingly', 'suprisingly', 'curiously'],
    'setTitleType': ['#roomAdjective.capitalize#', '#adverb.capitalize# #roomAdjective.capitalize#'],
    'title': '#setTitleType# #roomName.capitalize#',

    'setFeatureType': ['#feature#', '#featureAdjective# #feature#'],
    'description': [
        'You see ~#setFeatureType.a#~.',
        'You see ~#setFeatureType.a#~. And right next to it, ~#setFeatureType.a#~!',
        'You bend over, and spot several ~#setFeatureType.s#~.',
        'You hear a sound behind you and turn around. At your feet is ~#setFeatureType.a#~.',
        'You smell something strange. Following your nose, you find ~#setFeatureType.a#~ and some ~#setFeatureType.s#~.',
        'You peek round the door. There\'s nothing in the room but ~#setFeatureType.a#~.',
        'On the wall you see ~#setFeatureType.a#~. And on the ceiling, ~#setFeatureType.a#~.'
    ],

    'origin': '#[#setRoomName#]title#: #description#'
}

grammar = tracery.Grammar(rules)
grammar.add_modifiers(base_english)


def scrapeItems(description):
    items = []

    scraping = False
    item = ''
    for i in range(len(description)):
        if description[i] == "~":
            if not scraping:
                scraping = True
            else:
                items.append(item)
                item = ''
                scraping = False

        if scraping and description[i] != "~":
            item += description[i]

    return items


def removeTildes(description):
    output = ""

    for i in range(len(description)):
        if description[i] != "~":
            output += description[i]

    return output


def generate_room_content(n=100):
    rooms = []
    for i in range(n):
        roomString = grammar.flatten('#origin#')
        splitRoomString = roomString.split(": ")

        rooms.append({
            'title': splitRoomString[0],
            'description': removeTildes(splitRoomString[1]),
            'items': scrapeItems(splitRoomString[1])
        })

    return rooms


ROOMS = [{'title': 'Ransacked Passageway', 'description': 'You see a smoking cable.', 'items': ['a smoking cable']}, {'title': 'Dangerous-looking Engine-room', 'description': "You peek round the door. There's nothing in the room but a panel.", 'items': ['a panel']}, {'title': 'Puzzlingly Dark Quarters', 'description': "You peek round the door. There's nothing in the room but a light.", 'items': ['a light']}, {'title': 'Irradiated Medbay', 'description': 'You smell something strange. Following your nose, you find a sharp empty bed and some sharp empty beds.', 'items': ['a sharp empty bed', 'sharp empty beds']}, {'title': 'Suprisingly Quiet Bridge', 'description': 'You see a broken chair.', 'items': ['a broken chair']}, {'title': 'Stripped Laboratory', 'description': 'On the wall you see a test tube. And on the ceiling, a centrifuge.', 'items': ['a test tube', 'a centrifuge']}, {'title': 'Strangely Stripped Armoury', 'description': 'You hear a sound behind you and turn around. At your feet is an unfamiliar grenade.', 'items': ['an unfamiliar grenade']}, {'title': 'Strangely Full Bridge', 'description': "You peek round the door. There's nothing in the room but a broken flight computer.", 'items': ['a broken flight computer']}, {'title': 'Messy Passageway', 'description': 'You smell something strange. Following your nose, you find an oversized light and some lights.', 'items': ['an oversized light', 'lights']}, {'title': 'Curiously Dangerous-looking Quarters', 'description': 'You hear a sound behind you and turn around. At your feet is a mirror.', 'items': ['a mirror']}, {'title': 'Curiously Smoky Bridge', 'description': 'You smell something strange. Following your nose, you find a cable and some smoking flight computers.', 'items': ['a cable', 'smoking flight computers']}, {'title': 'Ransacked Engine-room', 'description': 'You see a light. And right next to it, a light!', 'items': ['a light', 'a light']}, {'title': 'Smoky Armoury', 'description': 'You bend over, and spot several grenades.', 'items': ['grenades']}, {'title': 'Ransacked Room', 'description': 'You smell something strange. Following your nose, you find a flashing cable and some regular panels.', 'items': ['a flashing cable', 'regular panels']}, {'title': 'Suprisingly Ransacked Brig', 'description': "You peek round the door. There's nothing in the room but a cable.", 'items': ['a cable']}, {'title': 'Suprisingly Empty Armoury', 'description': 'You smell something strange. Following your nose, you find an assault rifle and some grenades.', 'items': ['an assault rifle', 'grenades']}, {'title': 'Full Armoury', 'description': 'You hear a sound behind you and turn around. At your feet is a flashing pistol.', 'items': ['a flashing pistol']}, {'title': 'Worryingly Dangerous-looking Bridge', 'description': 'You bend over, and spot several flight computers.', 'items': ['flight computers']}, {'title': 'Worryingly Smoky Mess-hall', 'description': 'You see a smoking panel.', 'items': ['a smoking panel']}, {'title': 'Strangely Messy Armoury', 'description': 'On the wall you see an odd-looking panel. And on the ceiling, a panel.', 'items': ['an odd-looking panel', 'a panel']}, {'title': 'Empty Bridge', 'description': 'You see a sharp flight computer.', 'items': ['a sharp flight computer']}, {'title': 'Curiously Full Laboratory', 'description': 'You see an odd-looking lazer.', 'items': ['an odd-looking lazer']}, {'title': 'Messy Corridor', 'description': 'You hear a sound behind you and turn around. At your feet is a regular cable.', 'items': ['a regular cable']}, {'title': 'Suprisingly Dangerous-looking Medbay', 'description': 'You hear a sound behind you and turn around. At your feet is a smoking light.', 'items': ['a smoking light']}, {'title': 'Dark Passageway', 'description': 'You smell something strange. Following your nose, you find a broken cable and some lights.', 'items': ['a broken cable', 'lights']}, {'title': 'Messy Brig', 'description': 'On the wall you see a regular panel. And on the ceiling, a smoking handcuff.', 'items': ['a regular panel', 'a smoking handcuff']}, {'title': 'Suprisingly Full Laboratory', 'description': 'You hear a sound behind you and turn around. At your feet is an odd-looking test tube.', 'items': ['an odd-looking test tube']}, {'title': 'Suspiciously Full Corridor', 'description': 'On the wall you see a beeping light. And on the ceiling, a panel.', 'items': ['a beeping light', 'a panel']}, {'title': 'Full Brig', 'description': "You peek round the door. There's nothing in the room but a force field.", 'items': ['a force field']}, {'title': 'Stripped Laboratory', 'description': 'On the wall you see a test tube. And on the ceiling, a sharp test tube.', 'items': ['a test tube', 'a sharp test tube']}, {'title': 'Dangerous-looking Bridge', 'description': 'You hear a sound behind you and turn around. At your feet is a flashing chair.', 'items': ['a flashing chair']}, {'title': 'Dangerous-looking Laboratory', 'description': 'You hear a sound behind you and turn around. At your feet is an odd-looking panel.', 'items': ['an odd-looking panel']}, {'title': 'Suspiciously Dangerous-looking Bridge', 'description': 'You see a panel. And right next to it, a smoking panel!', 'items': ['a panel', 'a smoking panel']}, {'title': 'Worryingly Dangerous-looking Passageway', 'description': 'You bend over, and spot several unfamiliar cables.', 'items': ['unfamiliar cables']}, {'title': 'Suprisingly Full Quarters', 'description': 'You bend over, and spot several unfamiliar panels.', 'items': ['unfamiliar panels']}, {'title': 'Smoky Medbay', 'description': "You peek round the door. There's nothing in the room but a sharp panel.", 'items': ['a sharp panel']}, {'title': 'Irradiated Mess-hall', 'description': 'You smell something strange. Following your nose, you find a smoking vegetable and some vegetables.', 'items': ['a smoking vegetable', 'vegetables']}, {'title': 'Suprisingly Full Medbay', 'description': 'You hear a sound behind you and turn around. At your feet is an oversized empty bed.', 'items': ['an oversized empty bed']}, {'title': 'Worryingly Ransacked Quarters', 'description': "You peek round the door. There's nothing in the room but a cable.", 'items': ['a cable']}, {'title': 'Strangely Irradiated Medbay', 'description': 'You hear a sound behind you and turn around. At your feet is an odd-looking panel.', 'items': ['an odd-looking panel']}, {'title': 'Worryingly Stripped Medbay', 'description': "You peek round the door. There's nothing in the room but an oversized light.", 'items': ['an oversized light']}, {'title': 'Strangely Ransacked Corridor', 'description': "You peek round the door. There's nothing in the room but an unfamiliar light.", 'items': ['an unfamiliar light']}, {'title': 'Dark Corridor', 'description': 'You bend over, and spot several cables.', 'items': ['cables']}, {'title': 'Curiously Dangerous-looking Passageway', 'description': "You peek round the door. There's nothing in the room but an oversized panel.", 'items': ['an oversized panel']}, {'title': 'Messy Corridor', 'description': 'You smell something strange. Following your nose, you find a cable and some cables.', 'items': ['a cable', 'cables']}, {'title': 'Smoky Brig', 'description': "You peek round the door. There's nothing in the room but a panel.", 'items': ['a panel']}, {'title': 'Ransacked Bridge', 'description': 'You hear a sound behind you and turn around. At your feet is a panel.', 'items': ['a panel']}, {'title': 'Packed Mess-hall', 'description': 'On the wall you see a vegetable. And on the ceiling, an unfamiliar fruit.', 'items': ['a vegetable', 'an unfamiliar fruit']}, {'title': 'Quiet Engine-room', 'description': 'You hear a sound behind you and turn around. At your feet is a panel.', 'items': ['a panel']}, {'title': 'Strangely Quiet Engine-room', 'description': 'You see a broken panel.', 'items': ['a broken panel']}, {'title': 'Worryingly Empty Room', 'description': "You peek round the door. There's nothing in the room but a panel.", 'items': ['a panel']}, {'title': 'Suprisingly Quiet Laboratory', 'description': 'You hear a sound behind you and turn around. At your feet is a hot panel.', 'items': ['a hot panel']}, {'title': 'Quiet Quarters', 'description': 'You bend over, and spot several flashing mirrors.', 'items': ['flashing mirrors']}, {'title': 'Suspiciously Irradiated Engine-room', 'description': 'You bend over, and spot several regular green gelatinous puddles.', 'items': ['regular green gelatinous puddles']}, {'title': 'Full Medbay', 'description': "You peek round the door. There's nothing in the room but a cable.", 'items': ['a cable']}, {'title': 'Empty Bridge', 'description': 'You see a chair.', 'items': ['a chair']}, {'title': 'Full Mess-hall', 'description': "You peek round the door. There's nothing in the room but a regular fork.", 'items': ['a regular fork']}, {'title': 'Puzzlingly Full Medbay', 'description': 'You bend over, and spot several empty beds.', 'items': ['empty beds']}, {'title': 'Dark Quarters', 'description': 'You smell something strange. Following your nose, you find a sharp cable and some panels.', 'items': ['a sharp cable', 'panels']}, {'title': 'Strangely Full Corridor', 'description': 'You hear a sound behind you and turn around. At your feet is an unfamiliar panel.', 'items': ['an unfamiliar panel']}, {'title': 'Suprisingly Ransacked Engine-room', 'description': "You peek round the door. There's nothing in the room but a green gelatinous puddle.", 'items': ['a green gelatinous puddle']}, {'title': 'Suspiciously Messy Corridor', 'description': 'You see a broken light. And right next to it, a cable!', 'items': ['a broken light', 'a cable']}, {'title': 'Dangerous-looking Medbay', 'description': 'You smell something strange. Following your nose, you find a regular medkit and some odd-looking medkits.', 'items': ['a regular medkit', 'odd-looking medkits']}, {'title': 'Ransacked Bridge', 'description': 'You hear a sound behind you and turn around. At your feet is a cable.', 'items': ['a cable']}, {'title': 'Empty Laboratory', 'description': 'You bend over, and spot several centrifuges.', 'items': ['centrifuges']}, {'title': 'Strangely Packed Laboratory', 'description': 'You smell something strange. Following your nose, you find a lazer and some lights.', 'items': ['a lazer', 'lights']}, {'title': 'Full Laboratory', 'description': 'On the wall you see a hot light. And on the ceiling, a panel.', 'items': ['a hot light', 'a panel']}, {'title': 'Messy Brig', 'description': 'On the wall you see a light. And on the ceiling, a beeping force field.', 'items': ['a light', 'a beeping force field']}, {'title': 'Dark Room', 'description': "You peek round the door. There's nothing in the room but an oversized panel.", 'items': ['an oversized panel']}, {'title': 'Quiet Corridor', 'description': 'You smell something strange. Following your nose, you find a panel and some sharp panels.', 'items': ['a panel', 'sharp panels']}, {'title': 'Puzzlingly Quiet Passageway', 'description': 'You see a communicator.', 'items': ['a communicator']}, {'title': 'Messy Laboratory', 'description': 'You see a test tube.', 'items': ['a test tube']}, {'title': 'Curiously Packed Room', 'description': 'You see a regular panel.', 'items': ['a regular panel']}, {'title': 'Smoky Room', 'description': 'You see a panel.', 'items': ['a panel']}, {'title': 'Dark Armoury', 'description': 'On the wall you see an assault rifle. And on the ceiling, a regular odd-looking gun.', 'items': ['an assault rifle', 'a regular odd-looking gun']}, {'title': 'Strangely Dangerous-looking Mess-hall', 'description': 'You smell something strange. Following your nose, you find a cable and some unfamiliar fruits.', 'items': ['a cable', 'unfamiliar fruits']}, {'title': 'Smoky Laboratory', 'description': 'You smell something strange. Following your nose, you find a flashing centrifuge and some cables.', 'items': ['a flashing centrifuge', 'cables']}, {'title': 'Quiet Passageway', 'description': 'You hear a sound behind you and turn around. At your feet is a sharp cable.', 'items': ['a sharp cable']}, {'title': 'Strangely Ransacked Mess-hall', 'description': 'You see a smoking light. And right next to it, an odd-looking knife!', 'items': ['a smoking light', 'an odd-looking knife']}, {'title': 'Suspiciously Ransacked Quarters', 'description': 'On the wall you see a broken cable. And on the ceiling, a mirror.', 'items': ['a broken cable', 'a mirror']}, {'title': 'Dangerous-looking Mess-hall', 'description': 'You see a smoking plate. And right next to it, a pan!', 'items': ['a smoking plate', 'a pan']}, {'title': 'Worryingly Full Medbay', 'description': "You peek round the door. There's nothing in the room but a broken panel.", 'items': ['a broken panel']}, {'title': 'Curiously Quiet Mess-hall', 'description': 'You hear a sound behind you and turn around. At your feet is a sharp vegetable.', 'items': ['a sharp vegetable']}, {'title': 'Full Brig', 'description': 'You see a force field. And right next to it, a panel!', 'items': ['a force field', 'a panel']}, {'title': 'Dark Bridge', 'description': 'You bend over, and spot several beeping flight computers.', 'items': ['beeping flight computers']}, {'title': 'Worryingly Packed Engine-room', 'description': 'You hear a sound behind you and turn around. At your feet is an odd-looking pipe.', 'items': ['an odd-looking pipe']}, {'title': 'Irradiated Armoury', 'description': "You peek round the door. There's nothing in the room but a hot light.", 'items': ['a hot light']}, {'title': 'Suspiciously Stripped Corridor', 'description': 'You see a flashing light.', 'items': ['a flashing light']}, {'title': 'Puzzlingly Smoky Medbay', 'description': 'On the wall you see a hot light. And on the ceiling, a hot cable.', 'items': ['a hot light', 'a hot cable']}, {'title': 'Irradiated Quarters', 'description': "You peek round the door. There's nothing in the room but a flashing mirror.", 'items': ['a flashing mirror']}, {'title': 'Suspiciously Empty Bridge', 'description': 'You bend over, and spot several cables.', 'items': ['cables']}, {'title': 'Worryingly Dangerous-looking Armoury', 'description': 'You smell something strange. Following your nose, you find a beeping cable and some odd-looking phasers.', 'items': ['a beeping cable', 'odd-looking phasers']}, {'title': 'Dark Quarters', 'description': 'You hear a sound behind you and turn around. At your feet is a light.', 'items': ['a light']}, {'title': 'Suprisingly Ransacked Mess-hall', 'description': 'You see a panel.', 'items': ['a panel']}, {'title': 'Suspiciously Smoky Passageway', 'description': 'You bend over, and spot several lights.', 'items': ['lights']}, {'title': 'Puzzlingly Stripped Quarters', 'description': 'On the wall you see a light. And on the ceiling, a jewel.', 'items': ['a light', 'a jewel']}, {'title': 'Curiously Packed Room', 'description': "You peek round the door. There's nothing in the room but a smoking panel.", 'items': ['a smoking panel']}, {'title': 'Stripped Bridge', 'description': 'You see a light. And right next to it, a cable!', 'items': ['a light', 'a cable']}, {'title': 'Worryingly Packed Engine-room', 'description': 'You hear a sound behind you and turn around. At your feet is an unfamiliar green gelatinous puddle.', 'items': ['an unfamiliar green gelatinous puddle']}, {'title': 'Smoky Engine-room', 'description': 'You see a panel. And right next to it, a reactor!', 'items': ['a panel', 'a reactor']}]
print(ROOMS)


